# 我想要开发一个AI智能待办助理的web app，具体要求如下：

## 产品需求
 - 1. 用户的使用场景主要是移动端，手机打开一个 url 就可以直接访问
 - 2. 用户通过输入手机号登录，绑定唯一的账号
 - 3. 用户登录成功后，即显示日历页面，在日历页面上点击每天，在下方显示每天的待办任务清单，进入后默认显示当天的清单，排序按紧急程度
 - 4. 在日历页面上，显示一个悬浮的小圆点，点击这个小圆点，跳转到待办事项新增页面
 - 5. 在待办事项新增页面，只有一个文本输入框，用户通过输入一段话，后台进行自动分析，提取相关元素
 - 6. 待办事项的主要元素: `日期`,`时间`,`主题`,`具体描述`,`涉及人员`,`是否提醒`,`提醒方式`,`创建人`,`紧急程度`,`场景标签` 等
 - 7. 如果在用户的语音输入中没有完整提取到必要元素，可以通过对话的方式提示用户，或者询问用户，引导其补充完整
 - 8. 解析成功后，显示一个事项确认对话框，让用户查看并确认（有需要的可以手工微调）
 - 9. 不同用户之间，知道其他用户的账号、手机号，可以将任务共享，数据记录在`涉及人员`列表中
 - 10. `紧急程度` 有 一般、紧急，非常紧急， `场景标签` 可以用户自定义，可以有多个
 - 11. 

## 技术要求
 - 1. 基于 cloudflare 平台的 workers 和 pages 实现，数据存储使用 D1 数据库，登录用户信息 缓存 环境变量 等可以存储在 kv 中
 - 2. 调用 AI大模型 API来实现用户输入内容的分析和关键词提取，包括缺失的关键词询问和多轮引导等。
 - 3. 大模型主要信息，使用openrouter作为 llm provider，参数如下,
   BASE_URL=https://openrouter.ai/api/v1
   MODEL_NAME=deepseek/deepseek-r1-0528:free
   API_KEY=需要从OpenRouter平台获取
 - 4. 大模型的参数和平台对用户透明，程序部署时设置即可，不需要用户感知
 - 5. 界面设计要大方简洁，易于操作
 - 6. 

------

# 我要增加一个新feature，具体如下：

## 产品需求
 - 1. 用户经常会有一些在其他渠道的预约，或者收到一些通知安排，或者订票看表演等，在这些场景下，用户完成相关的预定后，通过截图、拍照等方式保留一张图片，图片里面会有具体的日期、时间、事项等内容，我希望新增一个上传图片的功能，后台使用ai分析图片内容，提取必要的信息，自动生成一条、或者多条待办事项。
 - 2. 建议在添加待办事项的'+'加号图标上面增加一个拍照的图标，表示使用拍照、上传图片，让用户来提交图片
 - 3. 我会给你几张图片，包含了几种不同的情况，你可以先看一下。（比如： 医院预约挂号的情况， 买票参加活动的情况， 以及学校里发了后续安排通知的情况）
 - 4. 文件 assets/1.jpg  是学校通知照片
 - 5. 文件 assets/2.jpg  是活动购票预约截图
 - 6. 文件 assets/3.jpg  是医院挂号照片

 ## 技术要求
  - 1. 请先看一下之前已经完成的项目，确保增加新feature 不要影响现有功能
  - 2. 依然使用 openrouter 作为llm的provider，但是具体模型不用 deepseek ，而使用 gemini，参数如下：
     MULTI_MODEL_NAME=google/gemini-2.0-flash-exp:free
     TEXT_MODEL_NAME=deepseek/deepseek-r1-0528:free
  - 3. 原来文字分析的场景还是使用 deepseek，图片识别的场景使用 gemini
  - 4. 用户上传的图片存放在 R2 对象存储里，D1 数据库内仅存放对应的 id 
  - 5. 

-------

# 我要优化一下日历显示的主界面，具体优化建议如下：

## 产品需求
 - 1. 目前在日历的每一天的右下角，如果当天有待办任务的，会显示一个小圆点，我希望调整为一个数字，显示的是当前还未完成的任务数量
 - 2. 日历上我希望能够明确显示，工作日、休息日，法定节假日 等，这样可以辅助用户更好地查看
 - 3. 这是可以查询工作日，休息日和法定节假日的接口，`https://api.apihubs.cn/holiday/get?size=500&month=202506` month参数传递的是月份，或者 `https://api.apihubs.cn/holiday/get?size=500&year=2025` year参数传递的是年份，供参考
 - 4. 日历上的每一天都要显示 工作日 、休息日 或者 法定节假日 ，显示清晰、明确即可

## 节假日API字段说明
```
/**
 * 节假日信息
 */
export interface Holiday {
    /**
     * 公历日期
     */
    date?: number;
    /**
     * 节假日，这里使用两位数字枚举表示节假日，其中特殊数字10表示非节假日，特殊数字99表示全部节假日
     */
    holiday?: number;
    /**
     * 是否为法定节假日（三倍工资）
     */
    holiday_legal?: number;
    /**
     * 其他节假日，枚举与节假日相同，表示同一天中的另一个节日，如 2020-10-01
     */
    holiday_or?: number;
    /**
     * 节假日调休，枚举与节假日相同
     */
    holiday_overtime?: number;
    /**
     * 是否为假期节假日
     */
    holiday_recess?: number;
    /**
     * 是否为节日当天
     */
    holiday_today?: number;
    /**
     * 农历日期
     */
    lunar_date?: number;
    /**
     * 农历月份
     */
    lunar_month?: number;
    /**
     * 农历年份
     */
    lunar_year?: number;
    /**
     * 农历一年中的第几天
     */
    lunar_yearday?: number;
    /**
     * 公历月份
     */
    month?: number;
    /**
     * 星期几
     */
    week?: number;
    /**
     * 是否为周末
     */
    weekend?: number;
    /**
     * 是否为工作日（包含调休在内需要上班的日子）
     */
    workday?: number;
    /**
     * 公历年份
     */
    year?: number;
    /**
     * 公历一年中的第几天
     */
    yearday?: number;
    /**
     * 公历一年中的第几周，注意这里的年份是ISO-8601周编号年份，始终以周一至周日为一周。如需获取7天为一周直接使用年份中的天数除7即可
     */
    yearweek?: number;
    [property: string]: any;
}
```

## 技术要求
 - 1. 请先看一下之前已经完成的项目，确保增加新feature 不要影响现有功能
 - 2. 创建一个新的tag v0.1-202506 
 - 3. 创建一个新分支 dev 并切换到这个分支，将新 feature 的改动增加在 dev 上
 - 4. 法定节假日的查询接口有一定的次数限制，请查询完成后，将本次的查询结果缓存下来，可以使用 KV 存储 或者 R2 对象存储 
 - 5. 




 # 待办草稿

 ## scrachpad

 1. 图片压缩（客户端） - 尤其是拍照 （按比例缩减即可）
 2. 